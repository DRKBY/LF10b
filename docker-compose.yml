services:
  db:
    image: mysql:8.0
    container_name: mysql-db
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: eHH
      MYSQL_USER: ehh_user
      MYSQL_PASSWORD: ehh_password
    volumes:
      - db_data:/var/lib/mysql
    networks:
      - ehh-net
  
  mail:
    image: mailserver/docker-mailserver:latest
    hostname: mail
    domainname: eHH.de
    container_name: mailserver
    ports:
      - "25:25"
      - "143:143"
      - "587:587"
      - "993:993"
    volumes:
      - ./maildata/:/var/mail/
      - ./mailstate/:/var/mail-state/
      - ./config/:/tmp/docker-mailserver/
    environment:
      - ENABLE_SPAMASSASSIN=1
      - ENABLE_CLAMAV=1
      - ONE_DIR=1
      - DMS_DEBUG=0
    cap_add:
      - NET_ADMIN
    restart: always
    networks:
      - ehh-net

volumes:
  db_data:

networks:
  ehh-net: